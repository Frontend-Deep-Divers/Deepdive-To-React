# 3ì¥ ë¦¬ì•¡íŠ¸ í›… ê¹Šê²Œ ì‚´í´ë³´ê¸°

# 3.1 ë¦¬ì•¡íŠ¸ì˜ ëª¨ë“  í›… íŒŒí—¤ì¹˜ê¸°

## 3.1.1 useState

í•¨ìˆ˜ ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œ ìƒíƒœë¥¼ ì •ì˜í•˜ê³ , ìƒíƒœë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” í›…ì…ë‹ˆë‹¤.

`useState`ëŠ” ë‚´ë¶€ì ìœ¼ë¡œ í´ë¡œì €ë¥¼ ì´ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ `useState`ì˜ ì‹¤í–‰ì´ ì¢…ë£Œëœ ì´í›„ì—ë„ ì§€ì—­ë³€ìˆ˜ì¸ stateë¥¼ ê³„ì† ì°¸ì¡°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### useState êµ¬í˜„

ëŒ€ëµì ìœ¼ë¡œ í‰ë‚´ ë‚¸ ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

```js
const MyReact = (function () {
  const global = {};
  let index = 0;

  function useState(initialState) {
    if (!global.states) {
      // ì•± ì „ì²´ì˜ states ë°°ì—´ ì´ˆê¸°í™”
      // ìµœì´ˆ ì ‘ê·¼ì´ë¼ë©´ ë¹ˆ ë°°ì—´ë¡œ ì´ˆê¸°í™”
      global.states = [];
    }
  }

  // states ì •ë³´ë¥¼ ì¡°íšŒí•´ì„œ í˜„ì¬ ìƒíƒœê°’ì´ ìˆëŠ”ì§€ í™•ì¸
  // ì—†ìœ¼ë©´ ì´ˆê¹ƒê°’ìœ¼ë¡œ ì„¤ì •
  const currentState = global.states[index] || initialState;
  global.states[index] = currentState;

  // ì¦‰ì‹œ ì‹¤í–‰ í•¨ìˆ˜ë¡œ setterë¥¼ ìƒì„±
  const setState = (function () {
    // í˜„ì¬ indexë¥¼ í´ë¡œì €ë¡œ ìƒì„±í•´ì„œ ë™ì¼ indexì— ì ‘ê·¼ ê°€ëŠ¥
    let currentIndex = index;
    return function (value) {
      global.states[currentIndex] = value;
      // ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ ì‹œì‘
    };
  })();
  // useStateë¥¼ ì‚¬ìš©í•  ë•Œë§ˆë‹¤ indexë¥¼ í•˜ë‚˜ì”© ì¶”ê°€í•˜ë©° indexëŠ” setStateì—ì„œ ì‚¬ìš©
  // í•˜ë‚˜ì˜ stateë§ˆë‹¤ indexê°€ í• ë‹¹ë˜ì–´ indexê°€ ë°°ì—´ì˜ ê°’(gloabal.states)ì„ ê°€ë¦¬í‚´
  index = index + 1;

  return [currentState, setState];

  function Component() {
    const [value, setValue] = useState(0);
    // ...
  }
})();
```

ì‹¤ì œ êµ¬í˜„ì²´ì™€ëŠ” ë‹¤ë¥´ë©°, ì‹¤ì œë¡œëŠ” `useReducer`ë¥¼ ì´ìš©í•´ êµ¬í˜„ë¼ ìˆìŠµë‹ˆë‹¤.

### ê²Œìœ¼ë¥¸ ì´ˆê¸°í™”

`useState`ì˜ ì¸ìˆ˜ë¡œ íŠ¹ì •í•œ ê°’ì„ ë„˜ê¸°ëŠ” í•¨ìˆ˜ë¥¼ ì¸ìˆ˜ë¡œ ë„£ì–´ ê²Œìœ¼ë¥¸ ì´ˆê¸°í™”ë¥¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```js
const [count, setCount] = useState(() => {
  Number.parseInt(window.localStorage.getItem(cacheKey));
});
```

`useState`ì˜ ì´ˆê¹ƒê°’ì´ ë³µì¡í•˜ê±°ë‚˜ ë¬´ê±°ìš´ ì—°ì‚°ì„ í¬í•¨í•˜ê³  ìˆì„ ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•¨ìˆ˜ëŠ” stateê°€ ì²˜ìŒ ë§Œë“¤ì–´ì§ˆ ë•Œë§Œ ì‚¬ìš©ë˜ë©° ë¦¬ë Œë”ë§ì´ ë°œìƒí•˜ë©´ í•¨ìˆ˜ì˜ ì‹¤í–‰ì´ ë¬´ì‹œë©ë‹ˆë‹¤.

`localStorage`ë‚˜ `sessionStorage`ì— ëŒ€í•œ ì ‘ê·¼, `map`, `filter`, `find` ê°™ì€ ë°°ì—´ì— ëŒ€í•œ ì ‘ê·¼ ë“± ì‹¤í–‰ ë¹„ìš©ì´ ë§ì´ ë“œëŠ” ê²½ìš°ì— ìœ ìš©í•©ë‹ˆë‹¤.

## 3.1.2 useEffect

ìƒëª…ì£¼ê¸° ë©”ì„œë“œì™€ ë¹„ìŠ·í•œ ë™ì‘ì„ í•˜ì§€ë§Œ ëŒ€ì²´í•˜ê¸° ìœ„í•´ ë§Œë“¤ì–´ì§„ í›…ì€ ì•„ë‹™ë‹ˆë‹¤.

`useEffect`ëŠ” ì•± ë‚´ ì»´í¬ë„ŒíŠ¸ì˜ ì—¬ëŸ¬ ê°’ë“¤ì„ í™œìš©í•´ ë™ê¸°ì ìœ¼ë¡œ ë¶€ìˆ˜ íš¨ê³¼ë¥¼ ë§Œë“œëŠ” ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤.

`useEffect`ëŠ” ì²«ë²ˆì§¸ ì¸ìˆ˜ë¡œ ì½œë°± í•¨ìˆ˜, ë‘ ë²ˆì§¸ ì¸ìˆ˜ë¡œ ì˜ì¡´ì„± ë°°ì—´ì„ ë°›ìŠµë‹ˆë‹¤.

`useEffect`ëŠ” ë‹¨ìˆœíˆ ë Œë”ë§í•  ë•Œë§ˆë‹¤ ì˜ì¡´ì„±ì— ìˆëŠ” ê°’ì„ ë³´ë©´ì„œ ì˜ì¡´ì„±ì˜ ê°’ì´ ë³€ê²½ë˜ì–´ ìˆìœ¼ë©´ ë¶€ìˆ˜ íš¨ê³¼ë¥¼ ì‹¤í–‰í•˜ëŠ” í‰ë²”í•œ í•¨ìˆ˜ì…ë‹ˆë‹¤.

### í´ë¦°ì—… í•¨ìˆ˜ì˜ ëª©ì 

```js
useEffect(() => {
  // ì´í™íŠ¸ ì‹¤í–‰ ì‹œ ë¡œì§

  return () => {
    // í´ë¦°ì—… í•¨ìˆ˜
    // ì»´í¬ë„ŒíŠ¸ ì–¸ë§ˆìš´íŠ¸ ì‹œ ë˜ëŠ” ë‹¤ìŒ useEffect ì‹¤í–‰ ì§ì „ì— í˜¸ì¶œ
  };
}, []);
```

`useEffect` ë‚´ì—ì„œ ë°˜í™˜ë˜ëŠ” í•¨ìˆ˜ì´ë©°, ì´ë²¤íŠ¸ë¥¼ ë“±ë¡í•˜ê³  ì§€ìš¸ ë•Œ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.

í´ë¦°ì—… í•¨ìˆ˜ëŠ” ì´ì „ stateë¥¼ ì°¸ì¡°í•´ ì‹¤í–‰ë©ë‹ˆë‹¤. `useEffect`ëŠ” ì½œë°±ì´ ì‹¤í–‰ë  ë•Œë§ˆë‹¤ ì´ì „ì˜ í´ë¦°ì—… í•¨ìˆ˜ê°€ ì¡´ì¬í•œë‹¤ë©´ ê·¸ í´ë¦°ì—… í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•œ ë’¤ì— ì½œë°±ì„ ì‹¤í–‰í•©ë‹ˆë‹¤. ì´ë²¤íŠ¸ ì¶”ê°€ ì „, ì´ì „ì— ë“±ë¡í–ˆë˜ ì´ë²¤íŠ¸ë¥¼ ì‚­ì œí•˜ëŠ” ì½”ë“œë¥¼ í´ë¦°ì—… í•¨ìˆ˜ì— ì¶”ê°€í•©ë‹ˆë‹¤.

í´ë¦°ì—… í•¨ìˆ˜ëŠ” ì–¸ë§ˆìš´íŠ¸ì™€ ë‹¤ë¥´ê²Œ ì˜ì¡´ì„± ë³€í™”ê°€ ìˆì—ˆì„ ë‹¹ì‹œ ì´ì „ ìƒíƒœë¥¼ ì²­ì†Œí•´ ì£¼ëŠ” ê°œë…ì— ê°€ê¹ìŠµë‹ˆë‹¤.

### ì˜ì¡´ì„± ë°°ì—´

ğŸ¤” `useEffect`ëŠ” ì˜ì¡´ì„± ë°°ì—´ì´ ì—†ëŠ” ê²½ìš°, ë§¤ ë Œë”ë§ë§ˆë‹¤ ì‹¤í–‰ë˜ëŠ”ë° ê·¸ëŸ¼ `useEffect` ì—†ì´ ì¨ë„ ë˜ì§€ ì•Šì„ê¹Œ?

`useEffect`ëŠ” ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ ê´€ì ì—ì„œ í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œì˜ ì‹¤í–‰ì„ ë³´ì¥í•˜ë©°, ê·¸ëŸ¬ë¯€ë¡œ `useEffect` ë‚´ë¶€ì—ì„œ `window` ê°ì²´ì˜ ì ‘ê·¼ì— ì˜ì¡´í•˜ëŠ” ì½”ë“œë¥¼ ì‚¬ìš©í•´ë„ ë©ë‹ˆë‹¤. ë˜í•œ `useEffect`ëŠ” ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ì´ ëë‚˜ê³  ì‹¤í–‰ë˜ì§€ë§Œ, ì—†ì´ ì“°ëŠ” ê²½ìš° ê·¸ë ‡ì§€ ì•Šê¸°ì— ë¬´ê±°ìš´ ì‘ì—…ì˜ ê²½ìš° ë Œë”ë§ì„ ë°©í•´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```js
const width = window.innerWidth; // ì„œë²„ì—ëŠ” windowê°€ ì—†ìœ¼ë¯€ë¡œ ì‹¤í–‰ ë¶ˆê°€!
```

### useEffect êµ¬í˜„

`useEffect`ì˜ ëŒ€ëµì ì¸ êµ¬í˜„ì„ ì‚´í´ë´…ì‹œë‹¤.

```js
const MyReact = (function () {
  const global = {};
  let index = 0;

  function useEffect(callback, dependencies) {
    const hooks = global.hooks;

    // ì´ì „ í›… ì •ë³´ í™•ì¸
    let previousDependencies = hooks[index];

    // ë³€ê²½ëëŠ”ì§€ í™•ì¸
    // ì´ì „ ê°’ì´ ìˆìœ¼ë©´ ì–•ì€ ë¹„êµë¡œ ë³€ê²½ í™•ì¸
    // ì—†ìœ¼ë©´ ë³€ê²½ìœ¼ë¡œ ê°„ì£¼í•´ ì‹¤í–‰
    let isDependenciesChanged = previousDependencies
      ? dependencies.some(
          (value, idx) => !Object.is(value, previousDependencies[idx])
        )
      : true;

    // ë³€ê²½ì´ ì¼ì–´ë‚˜ë©´ ì½œë°± í•¨ìˆ˜ ì‹¤í–‰
    if (isDependenciesChanged) {
      callback();

      // ë‹¤ìŒ í›…ì„ ëŒ€ë¹„í•´ index ì¶”ê°€
      index++;

      // í˜„ì¬ ì˜ì¡´ì„±ì„ í›…ì— ë‹¤ì‹œ ì €ì¥
      hooks[index] = dependencies;
    }

    return { useEffect };
  }
})();
```

ë¦¬ì•¡íŠ¸ëŠ” ê°’ì„ ë¹„êµí•  ë•Œ, `Object.is`ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì–•ì€ ë¹„êµë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.

âš ï¸ `useEffect`ë¥¼ ì‚¬ìš©í•  ë•Œ ì£¼ì˜í•  ì 

1. ë°˜ë“œì‹œ ì˜ì¡´ì„± ë°°ì—´ë¡œ ì „ë‹¬í•œ ê°’ì˜ ë³€ê²½ì— ì˜í•´ ì‹¤í–‰ë˜ê²Œ í•  ê²ƒ(ì½œë°± ë‚´ìˆ˜ì—ì„œ ì˜ì¡´ì„± ë°°ì—´ì— í¬í•¨ë¼ ìˆì§€ ì•Šì€ ê°’ì„ ì‚¬ìš©í•˜ì§€ ë§ ê²ƒ): `useEffect`ì˜ ì‚¬ìš© ì˜ë„ì™€ë„ ì í•©í•˜ì§€ ì•Šìœ¼ë©° ë²„ê·¸ì˜ ìœ„í—˜ì„±ì„ ì•ˆê²Œ ë©ë‹ˆë‹¤.
2. ì½œë°± í•¨ìˆ˜ë¡œ ê¸°ëª… í•¨ìˆ˜ë¥¼ ë„˜ê²¨ì¤„ ê²ƒ: `useEffect`ì˜ ëª©ì ì„ íŒŒì•…í•˜ê¸° ìš©ì´í•©ë‹ˆë‹¤.
3. ìµœëŒ€í•œ ê°„ê²°í•˜ê²Œ ê°€ë³ê²Œ ìœ ì§€í•  ê²ƒ: ë¶€ìˆ˜ íš¨ê³¼ ì‹¤í–‰ì„ ë‹´ë‹¹í•˜ë¯€ë¡œ ì•± ì„±ëŠ¥ì— ì•…ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆì¸¡ê°€ëŠ¥ì„±ì„ ìœ„í•´ ì˜ì¡´ì„± ë°°ì—´ì— ì—¬ëŸ¬ ë³€ìˆ˜ê°€ ë“¤ì–´ê°„ë‹¤ë©´ `useCallback`ì´ë‚˜ `useMemo` ë“± ì •ì œí•œ ë‚´ìš©ë§Œ `useEffect`ì— ë‹´ì•„ë‘ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.
4. ë¶ˆí•„ìš”í•œ ì™¸ë¶€í•¨ìˆ˜ë¥¼ ì¤„ì¼ ê²ƒ: `useEffect` ë‚´ì—ì„œ ì‚¬ìš©í•  ë¶€ìˆ˜ íš¨ê³¼ë¼ë©´ ë‚´ë¶€ì—ì„œ ë§Œë“¤ì–´ì„œ ì •ì˜í•˜ë©´ ê°„ê²°í•˜ê²Œ ìœ ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ğŸ¤” `useEffect`ì—ì„œ ì½œë°±ìœ¼ë¡œ ë¹„ë™ê¸° í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ê¸° ì–´ë ¤ìš´ ì´ìœ ?

ë°”ë€ ìƒíƒœë³´ë‹¤ ì´ì „ ìƒíƒœê°€ ì‘ë‹µì´ ë” ë¹¨ë¦¬ ì˜¨ë‹¤ë©´ ì´ì „ ìƒíƒœ ê¸°ë°˜ìœ¼ë¡œ ê²°ê³¼ê°€ ë‚˜ì˜¬ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ê²½ìŸ ìƒíƒœ(race condition)ì´ ë°œìƒí•  ìœ„í—˜ì´ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

ì¦‰ì‹œ ì‹¤í–‰ ë¹„ë™ê¸° í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ ì‚¬ìš©í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ë‹¤ë§Œ í•¨ìˆ˜ê°€ ìƒì„±ë˜ê³  ì‹¤í–‰ë˜ëŠ” ê²ƒì„ ë°˜ë³µí•˜ë¯€ë¡œ í´ë¦°ì—… í•¨ìˆ˜ì—ì„œ ì´ì „ ë¹„ë™ê¸° í•¨ìˆ˜ì— ëŒ€í•œ ì²˜ë¦¬ë¥¼ í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤. (`AbortController`ë¥¼ ì‚¬ìš©í•˜ëŠ” ë“±)

```js
useEffect(() => {
  const controller = new AbortController();

  const fetchData = async () => {
    try {
      const res = await fetch("/api/data", { signal: controller.signal });
      const json = await res.json();
      console.log(json);
    } catch (err) {
      if (err.name === "AbortError") {
        console.log("ìš”ì²­ ì¤‘ë‹¨ë¨");
      }
    }
  };

  fetchData();

  return () => {
    controller.abort(); // í´ë¦°ì—…ì—ì„œ ì¤‘ë‹¨
  };
}, []);
```

## 3.1.3 useMemo

ë¹„ìš©ì´ í° ì—°ì‚°ì— ëŒ€í•œ ê²°ê³¼ë¥¼ ì €ì¥í•´ë‘ê³  ì´ ê°’ì„ ë°˜í™˜í•˜ëŠ” í›…ì…ë‹ˆë‹¤.

ì¸ìˆ˜ë¡œ ì–´ë– í•œ ê°’ì„ ë°˜í™˜í•˜ëŠ” ìƒì„± í•¨ìˆ˜ì™€ í•´ë‹¹ í•¨ìˆ˜ê°€ ì˜ì¡´í•˜ëŠ” ê°’ì˜ ë°°ì—´ì„ ë°›ìŠµë‹ˆë‹¤.

## 3.1.4 useCallback

`useMemo`ì™€ ë‹¤ë¥´ê²Œ ì¸ìˆ˜ë¡œ ë„˜ê²¨ë°›ì€ ì½œë°± ìì²´ë¥¼ ê¸°ì–µí•©ë‹ˆë‹¤. `useCallback`ì€ íŠ¹ì • í•¨ìˆ˜ë¥¼ ìƒˆë¡œ ë§Œë“¤ì§€ ì•Šê³  ì¬ì‚¬ìš©í•˜ëŠ” í›…ì…ë‹ˆë‹¤.

`useMemo`ì™€ì˜ ìœ ì¼í•œ ì°¨ì´ëŠ” ë©”ëª¨ì´ì œì´ì…˜ ëŒ€ìƒì´ ê°’ì´ëƒ í•¨ìˆ˜ëƒì¼ ë¿ì…ë‹ˆë‹¤.

## 3.1.5 useRef

`useRef`ëŠ” `useState`ì™€ ë™ì¼í•˜ê²Œ ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì˜ ë Œë”ë§ì´ ì¼ì–´ë‚˜ë„ ë³€ê²½ ê°€ëŠ¥í•œ ìƒíƒœê°’ì„ ì €ì¥í•©ë‹ˆë‹¤.

ê·¸ëŸ¬ë‚˜ êµ¬ë³„ë˜ëŠ” ë‘ ê°€ì§€ ì°¨ì´ì ì´ ìˆìŠµë‹ˆë‹¤.

1. `useRef`ëŠ” ë°˜í™˜ê°’ì¸ ê°ì²´ ë‚´ë¶€ì— ìˆëŠ” `current`ë¡œ ì ‘ê·¼ ë˜ëŠ” ë³€ê²½í•  ìˆ˜ ìˆë‹¤.
2. `useRef`ëŠ” ê·¸ ê°’ì´ ë³€í•˜ë”ë¼ë„ ë Œë”ë§ì„ ë°œìƒì‹œí‚¤ì§€ ì•ŠëŠ”ë‹¤.

`useRef`ëŠ” ì»´í¬ë„ŒíŠ¸ê°€ ë Œë”ë§ë  ë•Œë§Œ ìƒì„±ë˜ë©°, ì»´í¬ë„ŒíŠ¸ ì¸ìŠ¤í„´ìŠ¤ê°€ ì—¬ëŸ¬ ê°œë¼ë„ ê°ê° ë³„ê°œì˜ ê°’ì„ ë°”ë¼ë´…ë‹ˆë‹¤.

ì¼ë°˜ì ìœ¼ë¡œ DOMì— ì ‘ê·¼í•  ë•Œ ê°€ì¥ ë§ì´ ì‚¬ìš©ë©ë‹ˆë‹¤.

ë Œë”ë§ì„ ë°œìƒì‹œí‚¤ì§€ ì•Šê³  ì›í•˜ëŠ” ìƒíƒœê°’ì„ ì €ì¥í•  ìˆ˜ ìˆë‹¤ëŠ” íŠ¹ì§•ì„ í™œìš©í•´, `useState`ì˜ ì´ì „ ê°’ì„ ì €ì¥í•˜ê±°ë‚˜ í•˜ëŠ” ë“±ì˜ ê¸°ëŠ¥ì„ êµ¬í˜„í•  ë•Œ ìœ ìš©í•©ë‹ˆë‹¤.

### useRef êµ¬í˜„

ë¦¬ì•¡íŠ¸ì—ì„œì˜ êµ¬í˜„ì€ ë‹¤ë¥´ì§€ë§Œ Preactì—ì„œì˜ êµ¬í˜„ì—ì„œ íŒíŠ¸ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```js
export function useRef(initialValue) {
  currentHook = 5; // ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì˜ í›… ìˆœì„œ
  return useMemo(() => {
    current: initialValue;
  }, []);
}
```

ê°ì²´ ê°’ì„ ë³€ê²½í•´ë„ ê°ì²´ë¥¼ ê°€ë¦¬í‚¤ëŠ” ì£¼ì†Œê°€ ë³€ê²½ë˜ì§€ ì•ŠëŠ” ì ì„

## 3.1.6 useContext

ì»¨í…ìŠ¤íŠ¸(Context)ëŠ” props drillingì„ ë°©ì§€í•˜ê¸° ìœ„í•œ ê°œë…ì…ë‹ˆë‹¤. ëª…ì‹œì ì¸ props ì „ë‹¬ì—†ì´ í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ì—ì„œ ê°’ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```jsx
const Context = createContext<{ hello: string } | undefined>(undefined);

// ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸
<>
  <Context.Provider value={{ hello: 'react '}}>
    <ChildComponent />
  </Context.Provider>
</>

...
// ìì‹ ì»´í¬ë„ŒíŠ¸
const value = useContext(Context);
```

`useContext`ëŠ” ê°€ì¥ ê°€ê¹Œìš´ `Provider`ì˜ ê°’ì„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë‹¤ìˆ˜ì˜ `Provider`ë‚˜ `useContext`ë¥¼ ì‚¬ìš©í•  ë•Œ ë³„ë„ í•¨ìˆ˜ë¡œ ê°ì‹¸ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ íƒ€ì… ì¶”ë¡ ì´ë‚˜ ìƒìœ„ ì— `Provider`ê°€ ì—†ëŠ” ê²½ìš°ì—ë„ ì‚¬ì „ì— ì‰½ê²Œ ì°¾ê¸° ì‰½ìŠµë‹ˆë‹¤.

âš ï¸ `useContext`ë¥¼ ì‚¬ìš©í•  ë•Œ ì£¼ì˜í• ì 

1. `useContext`ë¥¼ ì‚¬ìš©í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ë¥¼ ìµœì†Œí™”í•  ê²ƒ
2. ì¬ì‚¬ìš©ë˜ì§€ ì•Šì„ ì»´í¬ë„ŒíŠ¸ì—ë§Œ ì‚¬ìš©í•  ê²ƒ: `Provider`ì— ì˜ì¡´ì„±ì„ ê°€ì§€ê²Œ ë˜ë¯€ë¡œ ì•„ë¬´ ê³³ì—ë‚˜ ì¬ì‚¬ìš©í•˜ê¸° ì–´ë ¤ì›Œì§‘ë‹ˆë‹¤.
3. ìƒíƒœ ê´€ë¦¬ APIê°€ ì•„ë‹ˆë¼ëŠ” ê²ƒì„ ëª…ì‹¬í•  ê²ƒ: ìƒíƒœë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë‹¤ë¥¸ ìƒíƒœë¥¼ ë§Œë“¤ê±°ë‚˜, ìƒíƒœ ë³€í™”ë¥¼ ìµœì í™”í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì•„ë‹™ë‹ˆë‹¤.

ğŸ’¡ `useContext`ëŠ” ë‹¨ìˆœíˆ ìƒíƒœë¥¼ ì£¼ì…í•˜ëŠ” ê²ƒ ì´ì™¸ì—ëŠ” ì–´ë–¤ ê¸°ëŠ¥ë„ í•˜ì§€ ì•ŠìŒ

## 3.1.7 useReducer

`useState`ì™€ ë‹¤ë¥´ê²Œ ì¢€ ë” ë³µì¡í•œ ìƒíƒœê°’ì„ ë¯¸ë¦¬ ì •ì˜í•´ ë‘” ì‹œë‚˜ë¦¬ì˜¤ì— ë”°ë¼ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- ë°˜í™˜ê°’
  - `state`: ìƒíƒœ ê°’ì„ ì˜ë¯¸
  - `dispatcher`: `state`ë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜ë¡œ, ì¸ìˆ˜ë¡œ ìƒíƒœë¥¼ ë³€ê²½í•  ìˆ˜ ìˆëŠ” `action`ì„ ë„˜ê²¨ì¤€ë‹¤.
- ì¸ìˆ˜
  - 1. `reducer`: ê¸°ë³¸ `action`ì„ ì •ì˜í•˜ëŠ” í•¨ìˆ˜
  - 2. `initialState`: ì´ˆê¹ƒê°’ì„ ì˜ë¯¸
  - 3. `init`(ì˜µì…˜): ì´ˆê¹ƒê°’ì„ ì§€ì—° ìƒì„±ì‹œí‚¤ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜, ë„˜ê²¨ì¤„ ê²½ìš°, ê²Œìœ¼ë¥¸ ì´ˆê¸°í™”ë¥¼ ë°œìƒì‹œí‚¨ë‹¤.

`useReducer`ëŠ” ìƒíƒœ ì ‘ê·¼ì€ ì»´í¬ë„ŒíŠ¸ì—ì„œë§Œ, ìƒíƒœ ì—…ë°ì´íŠ¸ ë°©ë²•ì€ ì»´í¬ë„ŒíŠ¸ ì™¸ë¶€ë¡œ ë¶„ë¦¬í•˜ê³  ë¯¸ë¦¬ ì •ì˜í•œ `dispatcher`ì— ì˜í•´ì„œë§Œ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤. ë³µì¡í•œ ìƒíƒœ ì—…ë°ì´íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì¼ëª©ìš”ì—°í•˜ê²Œ íŒŒì•…í•  ìˆ˜ ìˆëŠ” ì¥ì ì´ ìˆìŠµë‹ˆë‹¤.

```jsx
// useReducerê°€ ì‚¬ìš©í•  stateë¥¼ ì •ì˜
type State = {
  count: number,
};

// stateì˜ ë³€í™”ë¥¼ ë°œìƒì‹œí‚¬ actionì˜ íƒ€ì…ê³¼ ë„˜ê²¨ì¤„ ê°’(payload)ì„ ì •ì˜
// ê° typeê³¼ payloadê°’ì€ ë³„ê°œì˜ íƒ€ì…ìœ¼ë¡œ ëª…ë£Œë„ ì–»ìœ¼ë©°, êµ³ì´ ê°ì²´ë¥¼
// ë‹¤ê°™ì´ íƒ€ì…í™”ëœ ë„¤ì´ë°ì´ ê°€ì¥ ëª…ë£Œí•¨
type Action = { type: "up" | "down" | "reset", payload?: State };

// ë¬´ê±°ìš´ ì—°ì‚°ì´ í¬í•¨ëœ ê²½ìš°ë¡œ ì´ˆê¸°í™” í•¨ìˆ˜
function init(count: State): State {
  return count;
}

// ì´ˆê¸°ê°’
const initialState: State = { count: 0 };

// ì•ì„œ ì„ ì–¸í•œ stateì™€ actionì„ ê¸°ë°˜ìœ¼ë¡œ stateê°€ ì–´ë–»ê²Œ ë³€ê²½ë ì§€ ì •ì˜
function reducer(state: State, action: Action): State {
  switch (action.type) {
    case "up":
      return { count: state.count + 1 };
    case "down":
      return { count: state.count - 1 > 0 ? state.count - 1 : 0 };
    case "reset":
      return init(action.payload || { count: 0 });
    default:
      throw new Error(`Unexpected action type ${action.type}`);
  }
}

export default function App() {
  const [state, dispatcher] = useReducer(reducer, initialState, init);

  function handleUpButtonClick() {
    dispatcher({ type: "up" });
  }

  function handleDownButtonClick() {
    dispatcher({ type: "down" });
  }

  function handleResetButtonClick() {
    dispatcher({ type: "reset", payload: { count: 1 } });
  }

  return (
    <div className="App">
      <h1>{state.count}</h1>
      <button onClick={handleUpButtonClick}>+</button>
      <button onClick={handleDownButtonClick}>-</button>
      <button onClick={handleResetButtonClick}>reset</button>
    </div>
  );
}
```

Preactì˜ `useState` ì½”ë“œëŠ” `useReducer`ë¡œ êµ¬í˜„ë¼ ìˆìŠµë‹ˆë‹¤. ë°˜ëŒ€ë¡œ `useReducer`ë¥¼ `useState`ë¡œ êµ¬í˜„í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

```js
const useReducer = (reducer, initialArg, init) => {
  const [state, setState] = useState(
    init ? () => init(initialArg) : initialArg
  );

  const dispatch = useCallback(
    (action) => setState((prev) => reducer(prev, action)),
    [reducer]
  );

  return useMemo(() => [state, dispatch], [state, dispatch]);
};
```

## 3.1.8 useImperativeHandle

ë¶€ëª¨ì—ê²Œì„œ ë„˜ê²¨ë°›ì€ `ref`ë¥¼ ì›í•˜ëŠ” ëŒ€ë¡œ ìˆ˜ì •í•  ìˆ˜ ìˆëŠ” í›…ì…ë‹ˆë‹¤.

`ref`ë¥¼ í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ë¡œ ì „ë‹¬í•˜ê³  ì‹¶ì„ ë•, `forwardRef`ë¥¼ ì‚¬ìš©í•˜ê³¤ í–ˆìŠµë‹ˆë‹¤. (19 ë²„ì „ë¶€í„°ëŠ” deprecated ë˜ì—ˆìœ¼ë©°, `ref`ë¥¼ ì¼ë°˜ propsì²˜ëŸ¼ ë°›ì„ ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.)

19 ë²„ì „ ì´ì „ì—ëŠ” ì˜ˆì•½ì–´ì¸ `ref`ëŠ” propsë¡œ ì“¸ ìˆ˜ ì—†ì—ˆìœ¼ë©°, `ref`ëŒ€ì‹  ë‹¤ë¥¸ ì´ë¦„ìœ¼ë¡œ ë°›ì„ ìˆ˜ ìˆê³ , ì¼ê´€ì„± ìˆëŠ” `ref` ì „ë‹¬ì„ ìœ„í•œ APIì¸ `forwardRef`ë¥¼ ì œê³µí–ˆì—ˆìŠµë‹ˆë‹¤. ì´ë¥¼ ìì‹ ì»´í¬ë„ŒíŠ¸ì—ì„œ ê°ì‹¸ì„œ `ref`ë¥¼ ë°›ëŠ” ì‹ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.

```jsx
import React, {
  useRef,
  useState,
  useImperativeHandle,
  forwardRef,
} from "react";

const Input = forwardRef((props, ref) => {
  // useImperativeHandleì„ ì‚¬ìš©í•˜ë©´ refì˜ ë™ì‘ì„ ì¶”ê°€ë¡œ ì •ì˜í•  ìˆ˜ ìˆë‹¤.
  useImperativeHandle(
    ref,
    () => ({
      alert: () => alert(props.value),
    }),
    // useEffectì˜ depsì™€ ê°™ë‹¤.
    [props.value]
  );

  return <input ref={ref} {...props} />;
});

function App() {
  // inputì— ì‚¬ìš©í•  ref
  const inputRef = useRef();

  // inputì˜ value
  const [text, setText] = useState("");

  function handleClick() {
    // inputRefì— ì¶”ê°€í•œ alertë¼ëŠ” ë™ì‘ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
    inputRef.current.alert();
  }

  function handleChange(e) {
    setText(e.target.value);
  }

  return (
    <>
      <Input ref={inputRef} value={text} onChange={handleChange} />
      <button onClick={handleClick}>Focus</button>
    </>
  );
}

export default App;
```

ì „ë‹¬ë°›ì€ `ref`ì— ì¶”ê°€ì ì¸ ë™ì‘ì„ ì •ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## 3.1.9 useLayoutEffect

`useEffect`ì™€ ë‹¤ë¥´ê²Œ, ëª¨ë“  DOM ì˜ ë³€ê²½ í›„ì— ì½œë°± í•¨ìˆ˜ ì‹¤í–‰ì´ ë™ê¸°ì ìœ¼ë¡œ ë°œìƒí•©ë‹ˆë‹¤. ë¸Œë¼ìš°ì €ì— ë³€ê²½ ì‚¬í•­ì´ ì‹¤ì œë¡œ ë°˜ì˜ë˜ê¸° ì „ì— ì½œë°± í•¨ìˆ˜ê°€ ì‹¤í–‰ëœë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

**DOMì€ ê³„ì‚°ëì§€ë§Œ í™”ë©´ì— ë°˜ì˜í•˜ê¸° ì „ì— í•˜ê³  ì‹¶ì€ ì‘ì—…ì´ ìˆì„ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.** íŠ¹ì • ìš”ì†Œì— ë”°ë¼ DOM ìš”ì†Œë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ ì• ë‹ˆë©”ì´ì…˜, ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ì œì–´ ë“± í™”ë©´ì— ë°˜ì˜ë˜ê¸° ì „ì— í•˜ê³  ì‹¶ì€ ì‘ì—…ì— ì‚¬ìš©í•œë‹¤ë©´, `useEffect`ë³´ë‹¤ ìì—°ìŠ¤ëŸ¬ìš´ ì‚¬ìš©ì ê²½í—˜ì„ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## 3.1.10 useDebugValue

ë””ë²„ê¹…í•˜ê³  ì‹¶ì€ ì •ë³´ë¥¼ í›…ì— ì‚¬ìš©í•˜ë©´ ë¦¬ì•¡íŠ¸ ê°œë°œì ë„êµ¬ì—ì„œ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## 3.1.11 í›…ì˜ ê·œì¹™

1. ì»´í¬ë„ŒíŠ¸ ìµœìƒë‹¨ì—ì„œë§Œ í›…ì„ í˜¸ì¶œí•´ì•¼ í•œë‹¤. ë°˜ë³µë¬¸ì´ë‚˜ ì¡°ê±´ë¬¸, ì¤‘ì²©ëœ í•¨ìˆ˜ ë‚´ì—ì„œ í›…ì„ ì‹¤í–‰í•  ìˆ˜ ì—†ë‹¤. ë§¤ ë Œë”ë§ë§ˆë‹¤ í›…ì˜ í˜¸ì¶œ ìˆœì„œë¥¼ ë³´ì¥í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì´ë‹¤.
2. ë¦¬ì•¡íŠ¸ í•¨ìˆ˜ ì»´í¬ë„ŒíŠ¸, í˜¹ì€ ì‚¬ìš©ì ì •ì˜ í›…ì—ì„œë§Œ í›…ì„ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤. ì¼ë°˜ JS í•¨ìˆ˜ì—ì„œëŠ” í›…ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.
