# 14장 웹사이트 보안을 위한 리액트와 웹페이지 보안 이슈

## 14.1 리액트에서 발생하는 크로스 사이트 스크립팅

- 크로스 사이트 스크립팅 (XSS) : 웹 사이트 개발자가 아닌 제 3자가 웹사이트에 악성 스크립트를 삽입해 실행할 수 있는 취약점
- XSS 이슈가 발생하는 이유는 다음과 같다.
- dangerouslySetIneerHTML prop
    - 특정 브라우저 DOM의 innerHTML을 특정한 내용으로 교체할 수 있는 방법으로 일반적으로 게시판과 같이 사용자나 관리자가 입력한 내용을 브라우저에 표시하는 용도로 사용된다.
    - 인수로 넘겨받은 문자열을 DOM에 그대로 표시하는데, 이때 인수로 받는 문자열에는 제한이 없어 문제가 생긴다.
- useRef를 활용한 직접 삽입
    - useRef를 활용하면 DOM에 innerHTML에 보안 취약점이 있는 스크립트를 삽입하면 위와 동일한 문제가 발생한다.
- 리액트에서 XSS 문제를 피하는 방법
    - npm에 있는 라이브러리를 사용하면 제 3자가 삽입할 수 있는 HTML을 안전한 HTML 코드로 한번 치환할 수 있다. 이를 새니타이즈(sanitize) 또는 이스케이프(escape)라고 한다.
    - 단순히 보여줄 때뿐만 아니라 사용자가 콘텐츠를 저장할 때도 한번 이스케이프 과정을 거치는 것이 더 효율적이고 안전하다.
    - 또한 개발자는 자신이 작성한 코드가 아닌 query, 사용자 입력 데이터 등 외부에 존재하는 모든 코드를 위험한 코드로 간주하고 이를 적절히 처리하는 것이 좋다.

## 14.2 getServerSideProps와 서버 컴포넌트를 주의하자

- 서버 사이드 렌더링과 서버 컴포넌트를 사용할 때 일반 사용자에게 노출되는 안 되는 정보들이 담겨 있을 수 있기에 브라우저에 정보를 내려줄 때는 조심해야 한다.
- getServerSideProps가 반환하는 값 또는 서버 컴포넌트에 반환하는 props는 반드시 필요한 값만으로만 철저하게 제한되어야 한다.

## 14.3 <a> 태그의 값에 적절한 제한을 둬야 한다.

- <a> 태그의 href에 javascript:로 시작하는 자바스크립트 코드를 넣어 페이지 이동을 막고 별도 이벤트 핸들러만 작동시키기 위해 사용할 수 있다.
- 이때 href에 사용자가 입력한 주소를 넣을 수 있다면 이 또한 보안 이슈로 이어질 수 있기에 href로 들어갈 값을 제한해야 한다.

## 14.4 HTTP 보안 헤더 설정하기

- HTTP 보안 헤더 : 브라우저가 렌더링하는 내용과 관련된 보안 취약점을 미연에 방지하기 위해 브라우저와 함께 작동하는 헤더
- Strict-Transport-Security : 모든 사이트가 HTTPS를 통해 접근해야 하며, 만약 HTTP로 접근하는 경우 이러한 모든 시도는 HTTPS로 변경되게 한다.
- X-XSS-Protection : 페이지에서 XSS 취약점이 발견되면 페이지 로딩을 중단하는 헤더
- X-Frame-Options : 페이지를 frame, iframe, embed, object 내부에서 렌더링을 허용할지를 나타낼 수 있다.
- Permissions-Policy : 웹 사이트에서 사용할 수 있는 기능과 사용할 수 없는 기능을 명시적으로 선언하는 헤더
- X-Content-Type-Options : Content-type 헤더에서 제공하는 MIME(인코딩 방식) 유형이 브라우저에 의해 임의로 변경되지 않게 하는 헤더