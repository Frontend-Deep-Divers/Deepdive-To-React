# 10장 리액트 17과 18의 변경 사항 알아보기

## 10.1 리액트 17 버전 살펴보기

- 리액트의 점진적인 업그레이드
    - 전체 애플리케이션 트리는 리액트 17이지만 일부 트리와 컴포넌트에 대해서만 리액트 18을 선택하는 점진적인 버전업이 가능하다.
- 이벤트 위임 방식의 변경
    - 리액트는 이벤트 핸들러를 해당 이벤트 핸들러를 추가한 각각의 DOM 요소에 부탁하는 것이 아니라, 이벤트 타입(click, change)당 하나의 핸들러를 루트에 부착한다.
    - 이벤트의 구성 단계
        - 캡처 : 이벤트 핸들러가 트리 최상단 요소부터 시작해서 실제 이벤트가 발생한 타깃 요소까지 내려가는 것을 의미한다.
        - 타깃 : 이벤트 핸들러가 타깃 노드에 도달하는 단계다. 이 단계에서 이벤트가 호출된다.
        - 버블링 : 이벤트가 발생한 요소에서부터 시작해 최상위 요소까지 다시 올라간다.
    - 이벤트 위임 : 이러한 이벤트 단계의 원리를 활용해 이벤트를 상위 컴포넌트에만 붙이는 것을 의미한다.
    - 리액트 16까지는 모두 document에서 수행되고 있었지만 17부터는 리액트 최상단 요소에 추가된다.
- import React from ‘react’가 더 이상 필요 없다 : 새로운 JSX transform
    - 16 버전까지는 JSX 변환을 사용하기 위해 코드 내에서 React를 사용하지 않더라도 `import React from ‘react’` 가 필요했다.
    - 허나 리액트 17부터는 바벨과 협력하여 import 구문 없이도 JSX를 변환할 수 있게 됐다. 이외에도 불필요한 import 구문을 삭제해 번들링 크기를 약간 줄일 수 있고, 컴포넌트 작성을 더욱 간결하게 해준다.
    - 16버전 까지는 JSX 코드를 변경은 해주지만 React.createElement 를 수행할 때 필요한 `import React from ‘react’` 까지 추가해주지는 않는다. 17 버전부터는 require구문도 같이 추가되어 JSX를 변환할 때 필요한 모듈인 react/jsx-runtime을 불러오게 된다.
- 그 밖의 주요 변경 사항
    - 이벤트 풀링 제거
        - 리액트에는 이벤트를 처리하기 위한 SyntheticEvent라는 이벤트가 있는데, 이 이벤트는 브라우저의 기본 이벤트를 한 번 더 감싼 이벤트 객체다.
        - 리액트는 이렇게 브라우저 기본 이벤트가 아닌한번 래핑한 이벤트를 사용하기 때문에 이벤트가 발생할 때마다 이 이벤트를 새로 만들어 메모리 누수가 일어났다.
        - 이벤트 풀링 : SyntheticEvent 풀을 만들어서 이벤트가 발생할 때마다 가져오는 것
    - useEffect 클린업 함수의 비동기 실행
        - 16버전까지는 동기적으로 클린업 함수가 처리되어 불필요한 성능 저하가 발생하였다.
        - 17부터는 화면이 완전히 업데이트된 이후에 클린업 함수가 비동기적으로 실행된다.
    - 컴포넌트의 undefined 반환에 대한 일관적인 처리
        - 16에서는 forwardRef나 memo에서 undefined를 반환하는 경우에는 별다른 에러가 발생하지 않았다.
        - 17부터는 에러가 정상적으로 발생한다.

## 10.2 리액트 18버전 살펴보기

- 새로 추가된 훅
    - useID
        - 컴포넌트별로 유니크한 값을 생성하는 새로운 훅이다.
        - 컴포넌트별로 고유한 값을 사용하려면 고려할 것이 많았다. 허나 useID를 사용하면 클라이언트와 서버에서 불일치를 피하면서 컴포넌트 내부의 고유한 값을 생성할 수 있게 됐다.
    - useTransition
        - UI 변경을 가로막지 않고 상태를 업데이트할 수 있는 리액트 훅
        - 상태 업데이트를 긴급하지 않은 것으로 간주해 무거운 렌더링 작업을 조금 미룰 수 있으며 사용자에게 더 나은 사용자 경험을 제공할 수 있다.
    - useDeferredValue
        - 리액트 컴포넌트 트리에서 리렌더링이 급하지 않은 부분을 지연할 수 있게 도와주는 훅
        - 디바운스는 고정된 지연 시간을 필요로 하지만, useDeferredValue는 고정된 지연 시간 없이 첫번째 렌더링이 완료된 이후에 지연된 렌더링을 수행한다.